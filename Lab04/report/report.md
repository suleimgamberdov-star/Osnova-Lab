---
## Front matter
title: "Отчёт по лабораторной работе №4"
subtitle: "Работа с программными пакетами"
author: "Сулейм Гамбердов"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки работы с репозиториями и менеджерами пакетов.

# Ход выполнения

## Работа с репозиториями

1. Выполнен вход в систему от имени суперпользователя с помощью команды **su -**.  
   Это необходимо, так как управление пакетами и репозиториями требует прав администратора.  

2. В каталоге **/etc/yum.repos.d/** изучены конфигурационные файлы репозиториев.  
   Обнаружены стандартные репозитории **Rocky Linux**:  
   - rocky-addons.repo  
   - rocky-devel.repo  
   - rocky-extras.repo  
   - rocky.repo  

   Просмотр содержимого файла **rocky.repo** показал секции *baseos*, *baseos-debug*, *baseos-source* с параметрами подключения к зеркалам, проверкой GPG-подписей и временем жизни метаданных.  

   ![Просмотр файлов репозиториев](Screenshot_1.png){ #fig:001 width=80% }

3. Команда **dnf repolist** вывела список доступных репозиториев:  
   - **appstream** – пакеты приложений и библиотек  
   - **baseos** – базовые системные пакеты  
   - **extras** – дополнительные инструменты  

   ![Список репозиториев](Screenshot_2.png){ #fig:002 width=80% }

4. Для поиска пакетов с ключевым словом *user* использована команда **dnf search user**.  
   Вывод содержит различные библиотеки и утилиты: *libuser*, *usermode*, *xdg-user-dirs* и другие. Это позволяет быстро находить пакеты по ключевым словам в имени и описании.  

   ![Поиск пакетов с ключевым словом user](Screenshot_3.png){ #fig:003 width=80% }

5. Перед установкой **nmap** изучена информация о пакете с помощью команд **dnf search nmap** и **dnf info nmap**.  
   Затем выполнена установка:  
   - **dnf install nmap** — устанавливает только базовый пакет nmap.  
   - **dnf install nmap\*** — устанавливает все пакеты, начинающиеся на *nmap*, включая nmap-ncat.  

   ![Установка пакета nmap](Screenshot_4.png){ #fig:004 width=80% }

6. Для удаления пакета применены команды:  
   - **dnf remove nmap** — удаляет только основной пакет.  
   - **dnf remove nmap\*** — удаляет также сопутствующие пакеты, например nmap-ncat.  

   ![Удаление пакета nmap](Screenshot_5.png){ #fig:005 width=80% }

7. Работа с группами пакетов:  
   - **dnf groups list** — список доступных и установленных групп.  
   - **dnf groups info "RPM Development Tools"** — подробная информация о составе группы.  
   - **dnf groupinstall "RPM Development Tools"** — установка инструментов для сборки RPM-пакетов.  
   - **dnf groupremove "RPM Development Tools"** — удаление группы.  

   ![Работа с группами пакетов](Screenshot_6.png){ #fig:006 width=80% }  
   ![Информация и установка группы RPM Development Tools](Screenshot_7.png){ #fig:007 width=80% }  
   ![Удаление группы RPM Development Tools](Screenshot_8.png){ #fig:008 width=80% }

8. Команда **dnf history** показала историю транзакций с ID, временем и действиями.  
   Для отката шестого по счёту действия выполнена команда **dnf history undo 6**.  
   В результате группа **RPM Development Tools** была восстановлена.  

   ![История транзакций и откат действий](Screenshot_9.png){ #fig:009 width=80% }

# Ход выполнения

## Использование rpm

1. Для установки текстового браузера **lynx** сначала был загружен rpm-пакет.  
   С помощью команды **dnf list lynx** проверена доступность пакета и его версия,  
   затем выполнена загрузка без установки при помощи опции **--downloadonly**.  

   ![Загрузка пакета lynx](Screenshot_10.png){ #fig:010 width=80% }

2. С помощью команды **find /var/cache/dnf/ -name lynx*** определён каталог, в который был сохранён загруженный пакет.  
   После перехода в этот каталог пакет установлен через **rpm -Uhv**.  

   ![Поиск и установка пакета lynx](Screenshot_11.png){ #fig:011 width=80% }

3. Для проверки расположения исполняемого файла использована команда **which lynx**,  
   которая показала путь */usr/bin/lynx*.  
   Далее с помощью **rpm -qf $(which lynx)** определено, что данный файл принадлежит пакету *lynx-2.9.0-6.el10.x86_64*.  

   ![Проверка принадлежности файла пакету](Screenshot_12.png){ #fig:012 width=80% }

4. Команда **rpm -qi lynx** вывела подробную информацию о пакете: версию, размер, лицензию, описание, URL проекта.  

   ![Информация о пакете lynx](Screenshot_13.png){ #fig:013 width=80% }

5. Для получения списка всех установленных файлов пакета применена команда **rpm -ql lynx**.  
   Отдельно список документации был выведен с помощью **rpm -qd lynx**, где содержатся файлы руководств и справочные материалы.  
   Дополнительно просмотрен мануал **man lynx**.  

   ![Список файлов пакета](Screenshot_14.png){ #fig:014 width=80% }  
   ![Список документации пакета](Screenshot_15.png){ #fig:015 width=80% }

6. С помощью **rpm -qc lynx** определены конфигурационные файлы пакета, расположенные в каталоге **/etc**.  

   ![Конфигурационные файлы lynx](Screenshot_17.png){ #fig:016 width=80% }

7. Команда **rpm -q --scripts lynx** показала наличие служебных скриптов, выполняемых на этапах установки и удаления пакета.  
   Они используются для настройки окружения, копирования конфигураций или очистки временных данных.  

8. Для проверки корректности установки браузер **lynx** был запущен под обычным пользователем.  
   Он открыл стартовую страницу Rocky Linux в текстовом виде, что подтверждает успешную установку.  

   ![Запуск lynx](Screenshot_16.png){ #fig:017 width=80% }

9. Завершающим шагом пакет был удалён командой **rpm -e lynx**.  
   Повторная проверка содержимого каталога подтвердила отсутствие установленного пакета.  

## Установка и изучение пакета dnsmasq

1. Для установки пакета **dnsmasq** использованы команды **dnf list dnsmasq** и **dnf install dnsmasq**.  
   Проверено, что пакет уже установлен в системе.  
   С помощью **which dnsmasq** определено расположение исполняемого файла — */usr/sbin/dnsmasq*.  

   ![Установка и проверка расположения исполняемого файла](Screenshot_18.png){ #fig:018 width=80% }

2. Команда **rpm -qf $(which dnsmasq)** подтвердила принадлежность бинарного файла пакету *dnsmasq-2.90-4.el10.x86_64*.  
   Дополнительно с помощью **rpm -qi dnsmasq** получена подробная информация о пакете: версия, лицензия, URL проекта, описание функционала (DNS, DHCP, TFTP-сервер).  

   ![Информация о пакете dnsmasq](Screenshot_19.png){ #fig:019 width=80% }

3. Для анализа содержимого пакета применена команда **rpm -ql dnsmasq**, которая вывела полный список установленных файлов (бинарные, конфигурационные, сервисные и документация).  
   Отдельно документация выведена командой **rpm -qd dnsmasq**.  
   Справка также просмотрена через **man dnsmasq**.  

   ![Список файлов пакета](Screenshot_20.png){ #fig:020 width=80% }  
   ![Руководство dnsmasq](Screenshot_21.png){ #fig:021 width=80% }

4. Конфигурационные файлы определены с помощью **rpm -qc dnsmasq**.  
   Основные настройки располагаются в каталогах */etc/* и */etc/dnsmasq.d/*.  

   ![Конфигурационные файлы dnsmasq](Screenshot_22.png){ #fig:022 width=80% }

5. Команда **rpm -q --scripts dnsmasq** показала наличие пред- и пост-скриптов, выполняемых при установке и удалении пакета.  
   Скрипты создают системного пользователя **dnsmasq**, настраивают службу systemd и обеспечивают корректную инициализацию сервиса при старте системы.  

6. Для завершения работы пакет можно удалить командой **rpm -e dnsmasq**.  
   После этого все его бинарные и конфигурационные файлы будут удалены из системы.  

# Контрольные вопросы

1. Какая команда позволяет вам искать пакет rpm, содержащий файл useradd?  
   - **rpm -qf /usr/sbin/useradd** — определяет, какому пакету принадлежит указанный файл.  
   - Также можно использовать **dnf provides /usr/sbin/useradd** для поиска пакета, содержащего бинарный файл.  

2. Какие команды вам нужно использовать, чтобы показать имя группы dnf, которая содержит инструменты безопасности, и показать, что находится в этой группе?  
   - **dnf group list** — выводит список доступных и установленных групп пакетов.  
   - **dnf group info "Security Tools"** — показывает содержимое выбранной группы, включая список пакетов.  

3. Какая команда позволяет вам установить rpm, который вы загрузили из Интернета и который не находится в репозиториях?  
   - **rpm -Uhv имя_пакета.rpm** — установка пакета напрямую из локального файла.  
   - Также можно использовать **dnf install ./имя_пакета.rpm**.  

4. Вы хотите убедиться, что пакет rpm, который вы загрузили, не содержит никакого опасного кода сценария. Какая команда позволяет это сделать?  
   - **rpm -qp --scripts имя_пакета.rpm** — показывает встроенные скрипты, выполняемые при установке или удалении пакета.  
   - Это позволяет убедиться в отсутствии вредоносного кода.  

5. Какая команда показывает всю документацию в rpm?  
   - **rpm -qd имя_пакета** — выводит список всех файлов документации, входящих в пакет.  

6. Какая команда показывает, какому пакету rpm принадлежит файл?  
   - **rpm -qf /путь/к/файлу** — определяет пакет, которому принадлежит данный файл.  

# Заключение

В ходе работы были изучены возможности управления пакетами в Linux с помощью утилит **dnf** и **rpm**.  
На практике выполнены установка, удаление и анализ пакетов, а также работа с группами и проверка содержимого, что позволило закрепить навыки администрирования системы.  
