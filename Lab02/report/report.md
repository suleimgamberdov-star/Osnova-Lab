---
## Front matter
title: "Отчёт по лабораторной работе №2"
subtitle: "Управление пользователями и группами"
author: "Сулейм Гамбердов"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить представление о работе с учётными записями пользователей и группами пользователей в операционной системе типа Linux.

# Ход выполнения

## Переключение учётных записей пользователей

1. Вход в систему выполнен под обычным пользователем **sigamberdov**.  
   Для определения текущей учётной записи использованы команды *whoami* и *id*.  
   Команда *whoami* возвращает имя активного пользователя, а *id* показывает UID, GID и группы, к которым он принадлежит.  
   Из вывода видно, что пользователь **sigamberdov** имеет UID=1000 и состоит в группе **wheel**, которая предоставляет права на выполнение административных действий через *sudo*.  

2. С помощью команды *su* выполнено переключение на учётную запись **root**.  
   После ввода пароля вывод *id* подтвердил смену пользователя: теперь активен UID=0, GID=0 и все действия выполняются от имени **root**.  

   ![Переключение к root и проверка идентификаторов](Screenshot_1.png){ #fig:001 width=80% }

3. Возврат к обычному пользователю выполнен командой *exit*.  

4. Для редактирования конфигурации прав администрирования открыт файл **/etc/sudoers** с помощью *visudo*.  
   Использование именно *visudo* является обязательным, так как эта утилита проверяет синтаксис при сохранении. Ошибка в файле при редактировании произвольным редактором может привести к полной потере доступа к команде *sudo* и, как следствие, невозможности администрирования системы.  

   ![Редактирование /etc/sudoers с помощью visudo](Screenshot_2.png){ #fig:002 width=80% }

5. В файле присутствует строка:  
   `%wheel ALL=(ALL) ALL`  
   Она означает, что все пользователи группы **wheel** могут выполнять любые команды от имени суперпользователя. Таким образом, группа **wheel** используется для предоставления административных прав.  

6. Создан новый пользователь **alice**, включённый в группу **wheel**.  
   Проверка через *id alice* подтвердила, что он действительно состоит в этой группе.  

   ![Создание пользователя alice и проверка его групп](Screenshot_3.png){ #fig:003 width=80% }

7. Для пользователя **alice** установлен пароль и выполнено переключение на его учётную запись.  

8. Под пользователем **alice** создан новый пользователь **bob**. Ему назначен пароль, после чего проведена проверка через *id bob*.  

9. Из вывода видно, что пользователь **bob** успешно создан и входит только в собственную группу без административных прав.  

## Создание учётных записей пользователей

1. Вход в систему выполнен под пользователем **root**.  

2. Открыт файл конфигурации **/etc/login.defs** и изменены параметры:  
   - **CREATE_HOME yes** — при создании пользователя автоматически создаётся домашний каталог.  
   - **USERGROUPS_ENAB no** — предотвращает автоматическое создание одноимённой группы для каждого нового пользователя; вместо этого используется группа **users**.  

   ![Редактирование параметров в /etc/login.defs](Screenshot_4.png){ #fig:004 width=80% }

3. Перейдено в каталог **/etc/skel**, в котором создаются шаблонные файлы и каталоги для новых пользователей. Созданы папки **Pictures** и **Documents**, чтобы они автоматически появлялись в домашних каталогах всех новых учётных записей.  

4. В файле **.bashrc**, расположенном в **/etc/skel**, добавлена строка:  
   `export EDITOR=/usr/bin/vim`  
   Это определяет текстовый редактор **vim** как редактор по умолчанию для инструментов, которым требуется редактирование конфигурационных файлов.  

   ![Изменение файла .bashrc в /etc/skel](Screenshot_5.png){ #fig:005 width=80% }

5. Переключение выполнено на пользователя **alice**. Под его учётной записью создан новый пользователь **carol** и установлен пароль.  

6. Проверка данных о пользователе **carol** командой *id* показала, что он принадлежит к группе **users**. Просмотр содержимого домашнего каталога подтвердил наличие созданных по умолчанию файлов и каталогов (**Documents**, **Pictures**, **.bashrc**, **.bash_profile** и др.).  

   ![Создание пользователя carol и проверка его домашнего каталога](Screenshot_6.png){ #fig:006 width=80% }

7. В файле **/etc/shadow** найдена запись о пользователе **carol**. В этой строке хранится хэш пароля, а также информация о сроках его действия и политике безопасности.  

8. Свойства пароля изменены:  
   - минимальный срок действия — 30 дней,  
   - предупреждение за 3 дня до истечения срока,  
   - максимальный срок действия — 90 дней.  

   После внесённых изменений в файле **/etc/shadow** отразились новые параметры.  

   ![Просмотр и изменение записи пароля пользователя carol](Screenshot_7.png){ #fig:007 width=80% }

9. Проверка содержимого системных файлов подтвердила:  
   - идентификатор пользователя **alice** присутствует во всех трёх файлах (**/etc/passwd**, **/etc/shadow**, **/etc/group**);  
   - идентификатор пользователя **carol** найден не во всех из них, что соответствует настройкам системы.  

## Работа с группами

1. Под пользователем **alice** были созданы новые группы **main** и **third**.  

2. Пользователи добавлены в группы:  
   - **alice** и **bob** включены в группу **main**;  
   - **carol** добавлена в группу **third**.  

3. Проверка с помощью команды *id carol* показала, что её основной группой является **users** (gid=100), а вторичной группой стала **third**.  

   ![Проверка добавления carol в группу third](Screenshot_8.png){ #fig:008 width=80% }

4. Вывод информации о других пользователях:  
   - Пользователь **bob** входит в основную группу с gid=1002 и состоит во вторичной группе **main**.  
   - Пользователь **alice** принадлежит к основной группе gid=1001, а также является участником групп **wheel** и **main**.  

# Контрольные вопросы

1. Для получения информации о пользователе и его группах можно использовать:  
   - **whoami** — выводит имя текущего пользователя;  
   - **id** — отображает UID, GID и список групп;  
   - **groups** — показывает, в какие группы входит пользователь.  

2. Пользователь **root** всегда имеет **UID=0**.  
   Узнать UID можно с помощью команды **id имя_пользователя**.  
   Например:  
   - `id root` → uid=0(root), gid=0(root).  
   - `id alice` → uid=1001(alice), gid=1001(alice).  

3. Отличие между **su** и **sudo**:  
   - **su** (substitute user) — переключает текущую сессию на другого пользователя, чаще всего на root, при вводе его пароля.  
   - **sudo** (substitute user do) — позволяет выполнить одну команду с правами другого пользователя (по умолчанию root), при этом запрашивает пароль текущего пользователя.  

4. Конфигурационные параметры **sudo** определяются в файле **/etc/sudoers**.  

5. Для безопасного изменения конфигурации sudo необходимо использовать команду **visudo**, которая проверяет синтаксис перед сохранением.  

6. Чтобы предоставить пользователю доступ ко всем командам администрирования через sudo, он должен быть членом группы **wheel**.  

7. Для настройки параметров создания учётных записей используются:  
   - Файл **/etc/login.defs** — определяет параметры, такие как:  
     - **CREATE_HOME yes** — создавать домашний каталог при добавлении пользователя;  
     - **USERGROUPS_ENAB no** — использовать общую группу users вместо создания отдельной группы.  
   - Каталог **/etc/skel** — содержит шаблонные файлы (например, `.bashrc`, `.bash_profile`), которые копируются в домашний каталог нового пользователя.  

8. Информация о группах хранится в следующих файлах:  
   - **/etc/passwd** — содержит запись о пользователе и его первичной группе (GID);  
   - **/etc/group** — хранит список групп и их участников;  
   - **/etc/shadow** — хранит хэш пароля и параметры его действия.  
   
   Пример записи для пользователя **alice**:  
   - `/etc/passwd`: `alice:x:1001:1001::/home/alice:/bin/bash` — UID=1001, GID=1001;  
   - `/etc/group`: `wheel:x:10:sigamberdov,alice` — alice состоит в группе wheel;  
   - `/etc/shadow`: хранит зашифрованный пароль и параметры его действия.  

9. Для изменения информации о пароле используются команды:  
   - **passwd** — изменение пароля;  
   - **chage** — настройка срока действия пароля (например, срок действия, минимальное время использования, предупреждения перед истечением).  

10. Для изменения информации в файле **/etc/group** следует использовать не прямое редактирование, а специальные команды:  
   - **groupadd**, **groupdel** — добавление и удаление групп;  
   - **usermod -aG** — добавление пользователя в группу.  
   
   Это делается потому, что ручное редактирование может привести к ошибкам и нарушению работы системы, тогда как системные команды проверяют корректность изменений.  


# Заключение  

В ходе работы были изучены основные приёмы управления пользователями и группами в Linux: создание и настройка учётных записей, работа с файлами конфигурации, назначение прав через группу wheel. Освоенные команды позволяют администрировать систему безопасно и эффективно, соблюдая требования к управлению доступом.  
